"use strict";var e,t;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e.CLOSE="closeWebView",e.GET_USER_INFO="getUserInfo",e.LOGIN="doLogin",e.GET_COMMON_PARAMS="getCommonParams",e.SAVE_FILE="saveImageToAlbum",e.QR_CODE_PARSER="callQRParser",e.SIGN="sign",e.SET_BAR_STATUS="setNativeBarStatus",e.SHOW_TOAST="showHint",e.QR_CODE_CLOSE="closeQRParser",e.SET_LOADING="setLoadingStatus",e.CALL_PHOTO_PICKER="callPhotoPicker",e.PURCHASE="purchase",e.GET_APP_PRODUCT_INFO="getIAPProductInfo",e.REPORT_EVENT="reportEvent",e.START_QR_SCAN="startQRScan",e.STOP_QR_SCAN="stopQRScan",e.REFRESH_CLIENT_DATA="refreshUserProjectsAndPresets",e.GET_CURRENT_ENV="getCurrentEnv",e.GET_H5_CACHE="getH5Cache",e.SET_H5_CACHE="setH5Cache",e.PLAY_VIDEO="playVideo",e.DO_SCAN="doScan",e.SAVE_RESOURCE="saveResource",e.APPLY_RESOURCE="applyResource",e.DO_LOCAL_CACHE="doLocalCache",e.SET_STATUS_BAR_STYLE="setStatusBarStyle",e.SHOW_SALES_PAGE="showSalesPage",e.REGISTER_NOTIFY="registerNotify",e.DO_SHARE="doShare",e.SET_HOME_TAB_BAR="setHomeTabbarStatus"}(e||(e={})),function(e){e.Prod="release",e.QA="qa",e.Dev="dev",e.Pre="operation"}(t||(t={}));var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var n=function(){return n=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},n.apply(this,arguments)};function i(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((o=o.apply(e,t||[])).next())}))}function a(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],o=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}function c(e){try{return JSON.parse(e)}catch(t){return e}}function s(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(e){return""}}var u=function(){function t(){this.IDIndex=0}return t.prototype.get=function(e){var t;return window.webkit&&window.webkit.messageHandlers&&(null===(t=window.webkit.messageHandlers[e])||void 0===t?void 0:t.postMessage)},t.prototype.execute=function(e,t){var r,o;return(null===(r=null===window||void 0===window?void 0:window.webkit)||void 0===r?void 0:r.messageHandlers.debugLogger)&&(null===(o=null===window||void 0===window?void 0:window.webkit)||void 0===o||o.messageHandlers.debugLogger(e,t)),window.webkit.messageHandlers[e].postMessage(t)},t.prototype.getUniqueID=function(){return"callback_".concat(this.IDIndex++)},t.prototype.bridgeCall=function(e,t,r){var o=this;return void 0===t&&(t={}),void 0===r&&(r={}),"function"!=typeof this.get(e)?(console.error(new Error("不存在type为".concat(e,"的方法可供调用！"))),Promise.reject({message:"invalid ".concat(e," method")})):new Promise((function(i,a){try{var u=n({},t),l=r.hasCallback,p=void 0===l||l,d=r.callbackFun,f=void 0;if(p){var h=o.getUniqueID();u.callback=h,f="function"!=typeof d?function(e){var t=c(e);return i(t),window[h]=null,t}:d,window[h]=f}var g=s(u);o.execute(e,g),"function"==typeof d&&i({})}catch(e){a(e)}}))},t.prototype.closePage=function(){this.bridgeCall(e.CLOSE,{_msg:"这条消息由前端发送，仅用于测试关闭接口调用"},{hasCallback:!1})},t.prototype.getUserInfo=function(){return this.bridgeCall(e.GET_USER_INFO)},t.prototype.login=function(){return this.bridgeCall(e.LOGIN)},t.prototype.getCommonParams=function(t){return this.bridgeCall(e.GET_COMMON_PARAMS)},t.prototype.saveFileByUrl=function(t){return this.bridgeCall(e.SAVE_FILE,{type:"url",data:t})},t.prototype.saveFileByBase64=function(t){return this.bridgeCall(e.SAVE_FILE,{type:"base64",data:t})},t.prototype.qrCodeOpen=function(t,r){return void 0===r&&(r="album"),this.bridgeCall(e.QR_CODE_PARSER,{scene:r},{callbackFun:t})},t.prototype.qrCodeClose=function(){return this.bridgeCall(e.QR_CODE_CLOSE)},t.prototype.qrCodeStop=function(){return this.bridgeCall(e.STOP_QR_SCAN)},t.prototype.qrCodeStart=function(){return this.bridgeCall(e.START_QR_SCAN)},t.prototype.sign=function(t){return this.bridgeCall(e.SIGN,t)},t.prototype.hideBar=function(){return this.bridgeCall(e.SET_BAR_STATUS,{status:!1},{hasCallback:!1})},t.prototype.showBar=function(){return this.bridgeCall(e.SET_BAR_STATUS,{status:!0},{hasCallback:!1})},t.prototype.showToast=function(t){return this.bridgeCall(e.SHOW_TOAST,{text:t})},t.prototype.showLoading=function(){return this.bridgeCall(e.SET_LOADING,{status:!0})},t.prototype.hideLoading=function(){return this.bridgeCall(e.SET_LOADING,{status:!1})},t.prototype.purchase=function(t,r){return this.bridgeCall(e.PURCHASE,{productId:t,method:r})},t.prototype.getAppProductInfo=function(t){return this.bridgeCall(e.GET_APP_PRODUCT_INFO,{productId:t})},t.prototype.reportEvent=function(t){return this.bridgeCall(e.REPORT_EVENT,t,{hasCallback:!1})},t.prototype.refreshApp=function(){return this.bridgeCall(e.REFRESH_CLIENT_DATA,{},{hasCallback:!1})},t.prototype.getEnvironment=function(){return this.bridgeCall(e.GET_CURRENT_ENV)},t.prototype.getCache=function(t){try{return this.bridgeCall(e.GET_H5_CACHE).then((function(e){var r=c(e||"{}")||{};return Promise.resolve(t?r[t]:r)}))}catch(e){return console.error(e),Promise.reject(e)}},t.prototype.setCache=function(t,r){var o=this;return this.getCache().then((function(n){var i,a=Object.assign({},n,((i={})[t]=r,i));return o.bridgeCall(e.SET_H5_CACHE,{body:s(a)})}))},t.prototype.clearCache=function(){return this.bridgeCall(e.SET_H5_CACHE,{body:s({})})},t.prototype.playVideoByApp=function(t){return i(this,void 0,void 0,(function(){return a(this,(function(r){return[2,this.bridgeCall(e.PLAY_VIDEO,{data:t})]}))}))},t}(),l=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return o(r,t),r.prototype.get=function(e){var t;return window.webkit&&window.webkit.messageHandlers&&(null===(t=window.webkit.messageHandlers[e])||void 0===t?void 0:t.postMessage)},r.prototype.doScanWithKeyWord=function(t,r){return this.bridgeCall(e.DO_SCAN,{keyword:t,page:r})},r.prototype.doScanWithQRInfo=function(t,r){return this.bridgeCall(e.DO_SCAN,{QRInfo:t,page:r})},r.prototype.saveResource=function(t,r){return this.bridgeCall(e.SAVE_RESOURCE,{type:t,id:r})},r.prototype.applyResource=function(t,r){return this.bridgeCall(e.APPLY_RESOURCE,{type:t,id:r})},r.prototype.doLocalCache=function(t,r){return this.bridgeCall(e.DO_LOCAL_CACHE,{url:t,key:r})},r.prototype.setStatusBarStyle=function(t){return this.bridgeCall(e.SET_STATUS_BAR_STYLE,{style:t})},r.prototype.showSalesPage=function(){return this.bridgeCall(e.SHOW_SALES_PAGE,{})},r.prototype.registerNotify=function(t){return void 0===t&&(t="network"),this.bridgeCall(e.REGISTER_NOTIFY,{notifyType:t})},r.prototype.doShare=function(t,r){return this.bridgeCall(e.DO_SHARE,{text:t,rect:r})},r.prototype.showHomeTabBar=function(){this.bridgeCall(e.SET_HOME_TAB_BAR,{hidden:!1})},r.prototype.hideHomeTabBar=function(){this.bridgeCall(e.SET_HOME_TAB_BAR,{hidden:!0})},r}(u),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.prototype.get=function(e){return function(){}},r.prototype.execute=function(e,t){console.warn("H5模式下，不支持".concat(e,"方法的调用！"))},r.prototype.getUserInfo=function(){return Promise.resolve({vip:"no",hasFreeTicketToReceive:!0,collectedFreeTicketsCount:0,freeTicketCountConfig:888,balanceInvite:0,isLogin:!0,isVip:!0,isBindApple:!1,userId:"6501190edd88ea45697c59c5",vipExpireTime:"0",avater:"http://cloudcdn.c360dn.com/b02c799359294fb3fe054fa3baa7b38a-200",presetTotalIncome:9,presetCount:96,nickname:"文闪",balanceJuice:28,userToken:"V1RSRldueUpGV3lkTnAwR0lleDJtL2V5RUY1ZHlSeUJVNWphQWFESWtqWEVsL3BtVU9DVk1oU3M5c1pWR0UzOUhTZEhYOXA2SW95a09uZ0ZwY2p4cGVGWWl0T21TZktodzdpSE1FMzVnRXFpZVFTbmE1cVhxbHFRUWFpMVdWTmpHcGVKN2p2TEFWbW50NXg0QXRzVUhxN1UxelNHUlN5Tw=="})},r.prototype.login=function(){return this.getUserInfo()},r.prototype.getCommonParams=function(e){return i(this,void 0,void 0,(function(){var t,r;return a(this,(function(o){switch(o.label){case 0:return[4,this.getEnvironment()];case 1:return t=o.sent(),r=e||{},[2,Promise.resolve(n({"PG-AppID":"VideoBeats","PG-AppVersion":"1.9.00","PG-Channel":"toolchain","PG-DataEnv":t,"PG-Debug":"0","PG-EID":"d241c0694472aebc739d509eb740d52e3d6fc2021f9d71e0c6371fe91afbf51f96db1c91453b376a60f0d0e702cff2ab","PG-ENCB":"0","PG-ENCH":"0","PG-FA":"6f97129290a3e4c7c340154b9c30c431","PG-InitStamp":"1700039392","PG-Language":"zh-Hans","PG-Locale":"zh_CN","PG-Model":"iPad11,3","PG-Network":"WIFI","PG-OSVersion":"15.4.1","PG-Platform":"iOS","PG-ScreenSize":"834.0*1112.0","PG-Time":"1702620070","PG-UpgradeStamp":"1702547225","PG-UserID":"6501190edd88ea45697c59c5","PG-UserToken":"V1RSRldueUpGV3lkTnAwR0lleDJtL2V5RUY1ZHlSeUJVNWphQWFESWtqWEVsL3BtVU9DVk1oU3M5c1pWR0UzOUhTZEhYOXA2SW95a09uZ0ZwY2p4cGVGWWl0T21TZktodzdpSE1FMzVnRXFpZVFTbmE1cVhxbHFRUWFpMVdWTmpHcGVKN2p2TEFWbW50NXg0QXRzVUhxN1UxelNHUlN5Tw==","PG-UtcOffset":"28800"},r))]}}))}))},r.prototype.sign=function(e){return Promise.resolve("56610f9fce1cdd07098cd81d")},r.prototype.showToast=function(e){return alert(e),Promise.resolve()},r.prototype.getEnvironment=function(){var e,r=location.hostname;return e=r.includes("-dev")||r.startsWith("local")||r.startsWith("1")?t.Dev:r.includes("-qa")?t.QA:t.Prod,Promise.resolve(e)},r.prototype.getCache=function(e){try{var t=localStorage.getItem("BRIDGE_WEB_CACHE");if(!t)return Promise.resolve();var r=c(t);return Promise.resolve(e?r[e]:r)}catch(e){return Promise.reject(e)}},r.prototype.setCache=function(e,t){return this.getCache().then((function(r){var o,n=Object.assign({},r,((o={})[e]=t,o));return localStorage.setItem("BRIDGE_WEB_CACHE",s(n)),t}))},r.prototype.clearCache=function(){return localStorage.removeItem("BRIDGE_WEB_CACHE"),Promise.resolve()},r}(l),d=function(){function t(){}return t.createBridge=function(e,r){void 0===r&&(r=this.getPlatform()),setTimeout((function(){console.log("app: ".concat(e,", platform: ").concat(r))}),500);var o="".concat(e,"-").concat(r),n=t.bridgeMap[o];return n?new n:(console.error("未找到".concat(o,"的Bridge，已使用兜底方案，请进行适配!")),new u)},t.createBlurrrBridge=function(){return this.createBridge("blurrr")},t.getPlatform=function(){var e=window.navigator.userAgent.toLowerCase();if(setTimeout((function(){console.log("ua: ".concat(e))}),500),window.webkit&&/pinguo/.test(e)){if(/android/.test(e))return"android";if(/iphone|ipad|ipod|mac/.test(e))return"ios"}return"web"},t.version="1.0.16",t.bridgeMap={"blurrr-ios":l,"blurrr-web":p},t.EBridgeType=e,t}(),f=d,h={bridge:d};exports.PGBridge=f,exports.default=h;
//# sourceMappingURL=js-sdk.common.js.map
