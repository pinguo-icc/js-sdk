!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["js-sdk"]={})}(this,(function(e){"use strict";var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},t(e,r)};function r(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n,o,i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function c(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}u((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(u){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,n=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}function u(e){try{return JSON.parse(e)}catch(t){return e}}function s(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(e){return""}}!function(e){e.CLOSE="closeWebView",e.GET_USER_INFO="getUserInfo",e.LOGIN="doLogin",e.GET_COMMON_PARAMS="getCommonParams",e.SAVE_FILE="saveImageToAlbum",e.QR_CODE_PARSER="callQRParser",e.SIGN="sign",e.SET_BAR_STATUS="setNativeBarStatus",e.SHOW_TOAST="showHint",e.QR_CODE_CLOSE="closeQRParser",e.SET_LOADING="setLoadingStatus",e.CALL_PHOTO_PICKER="callPhotoPicker",e.PURCHASE="purchase",e.GET_APP_PRODUCT_INFO="getIAPProductInfo",e.REPORT_EVENT="reportEvent",e.START_QR_SCAN="startQRScan",e.STOP_QR_SCAN="stopQRScan",e.REFRESH_CLIENT_DATA="refreshUserProjectsAndPresets",e.GET_CURRENT_ENV="getCurrentEnv",e.GET_H5_CACHE="getH5Cache",e.SET_H5_CACHE="setH5Cache",e.PLAY_VIDEO="playVideo"}(n||(n={})),function(e){e.Prod="release",e.QA="qa",e.Dev="dev",e.Pre="operation"}(o||(o={}));var l=function(){function e(){this.IDIndex=0}return e.prototype.get=function(e){var t;return window.webkit&&window.webkit.messageHandlers&&(null===(t=window.webkit.messageHandlers[e])||void 0===t?void 0:t.postMessage)},e.prototype.execute=function(e,t){return window.webkit.messageHandlers[e].postMessage(t)},e.prototype.getUniqueID=function(){return"callback_".concat(this.IDIndex++)},e.prototype.bridgeCall=function(e,t,r){var n=this;return void 0===t&&(t={}),void 0===r&&(r={}),"function"!=typeof this.get(e)?(console.error(new Error("不存在type为".concat(e,"的方法可供调用！"))),Promise.reject({message:"invalid ".concat(e," method")})):new Promise((function(o,a){try{var c=i({},t),l=r.hasCallback,p=void 0===l||l,f=r.callbackFun,d=void 0;if(p){var h=n.getUniqueID();c.callback=h,d="function"!=typeof f?function(e){var t=u(e);return o(t),window[h]=null,t}:f,window[h]=d}var b=s(c);n.execute(e,b),"function"==typeof f&&o({})}catch(e){a(e)}}))},e.prototype.closePage=function(){this.bridgeCall(n.CLOSE,{},{hasCallback:!1})},e.prototype.getUserInfo=function(){return this.bridgeCall(n.GET_USER_INFO)},e.prototype.login=function(){return this.bridgeCall(n.LOGIN)},e.prototype.getCommonParams=function(){return this.bridgeCall(n.GET_COMMON_PARAMS)},e.prototype.saveFileByUrl=function(e){return this.bridgeCall(n.SAVE_FILE,{type:"url",data:e})},e.prototype.saveFileByBase64=function(e){return this.bridgeCall(n.SAVE_FILE,{type:"base64",data:e})},e.prototype.qrCodeOpen=function(e){return this.bridgeCall(n.QR_CODE_PARSER,{},{callbackFun:e})},e.prototype.qrCodeClose=function(){return this.bridgeCall(n.QR_CODE_CLOSE)},e.prototype.qrCodeStop=function(){return this.bridgeCall(n.STOP_QR_SCAN)},e.prototype.qrCodeStart=function(){return this.bridgeCall(n.START_QR_SCAN)},e.prototype.sign=function(e){return this.bridgeCall(n.SIGN,e)},e.prototype.hideBar=function(){return this.bridgeCall(n.SET_BAR_STATUS,{status:!1},{hasCallback:!1})},e.prototype.showBar=function(){return this.bridgeCall(n.SET_BAR_STATUS,{status:!0},{hasCallback:!1})},e.prototype.showToast=function(e){return this.bridgeCall(n.SHOW_TOAST,{text:e})},e.prototype.showLoading=function(){return this.bridgeCall(n.SET_LOADING,{status:!0})},e.prototype.hideLoading=function(){return this.bridgeCall(n.SET_LOADING,{status:!1})},e.prototype.purchase=function(e,t){return this.bridgeCall(n.PURCHASE,{productId:e,method:t})},e.prototype.getAppProductInfo=function(e){return this.bridgeCall(n.GET_APP_PRODUCT_INFO,{productId:e})},e.prototype.reportEvent=function(e){return this.bridgeCall(n.REPORT_EVENT,e,{hasCallback:!1})},e.prototype.refreshApp=function(){return this.bridgeCall(n.REFRESH_CLIENT_DATA,{},{hasCallback:!1})},e.prototype.getEnvironment=function(){return this.bridgeCall(n.GET_CURRENT_ENV)},e.prototype.getCache=function(e){try{return this.bridgeCall(n.GET_H5_CACHE).then((function(t){var r=u(t||"{}")||{};return Promise.resolve(e?r[e]:r)}))}catch(e){return console.error(e),Promise.reject(e)}},e.prototype.setCache=function(e,t){var r=this;return this.getCache().then((function(o){var i,a=Object.assign({},o,((i={})[e]=t,i));return r.bridgeCall(n.SET_H5_CACHE,{body:s(a)})}))},e.prototype.clearCache=function(){return this.bridgeCall(n.SET_H5_CACHE,{body:s({})})},e.prototype.playVideoByApp=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){return[2,this.bridgeCall(n.PLAY_VIDEO,{data:e})]}))}))},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.get=function(e){var t;return window.webkit&&window.webkit.messageHandlers&&(null===(t=window.webkit.messageHandlers[e])||void 0===t?void 0:t.postMessage)},t}(l),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.get=function(e){return function(){}},t.prototype.execute=function(e,t){console.warn("H5模式下，不支持".concat(e,"方法的调用！"))},t.prototype.getUserInfo=function(){return Promise.resolve({vip:"no",hasFreeTicketToReceive:!0,collectedFreeTicketsCount:0,freeTicketCountConfig:888,balanceInvite:0,isLogin:!0,isVip:!0,isBindApple:!1,userId:"6501190edd88ea45697c59c5",vipExpireTime:"0",avater:"http://cloudcdn.c360dn.com/b02c799359294fb3fe054fa3baa7b38a-200",presetTotalIncome:9,presetCount:96,nickname:"文闪",balanceJuice:28,userToken:"V1RSRldueUpGV3lkTnAwR0lleDJtL2V5RUY1ZHlSeUJVNWphQWFESWtqWEVsL3BtVU9DVk1oU3M5c1pWR0UzOUhTZEhYOXA2SW95a09uZ0ZwY2p4cGVGWWl0T21TZktodzdpSE1FMzVnRXFpZVFTbmE1cVhxbHFRUWFpMVdWTmpHcGVKN2p2TEFWbW50NXg0QXRzVUhxN1UxelNHUlN5Tw=="})},t.prototype.login=function(){return this.getUserInfo()},t.prototype.getCommonParams=function(){return a(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return[4,this.getEnvironment()];case 1:return e=t.sent(),[2,Promise.resolve({"PG-AppID":"VideoBeats","PG-AppVersion":"1.9.00","PG-Channel":"toolchain","PG-DataEnv":e,"PG-Debug":"1","PG-EID":"d241c0694472aebc739d509eb740d52e3d6fc2021f9d71e0c6371fe91afbf51f96db1c91453b376a60f0d0e702cff2ab","PG-ENCB":"0","PG-ENCH":"1","PG-FA":"6f97129290a3e4c7c340154b9c30c431","PG-InitStamp":"1700039392","PG-Language":"zh-Hans","PG-Locale":"zh_CN","PG-Model":"iPad11,3","PG-Network":"WIFI","PG-OSVersion":"15.4.1","PG-Platform":"iOS","PG-ScreenSize":"834.0*1112.0","PG-Time":"1702620070","PG-UpgradeStamp":"1702547225","PG-UserID":"6501190edd88ea45697c59c5","PG-UserToken":"V1RSRldueUpGV3lkTnAwR0lleDJtL2V5RUY1ZHlSeUJVNWphQWFESWtqWEVsL3BtVU9DVk1oU3M5c1pWR0UzOUhTZEhYOXA2SW95a09uZ0ZwY2p4cGVGWWl0T21TZktodzdpSE1FMzVnRXFpZVFTbmE1cVhxbHFRUWFpMVdWTmpHcGVKN2p2TEFWbW50NXg0QXRzVUhxN1UxelNHUlN5Tw==","PG-UtcOffset":"28800"})]}}))}))},t.prototype.sign=function(e){return Promise.resolve("56610f9fce1cdd07098cd81d")},t.prototype.showToast=function(e){return alert(e),Promise.resolve()},t.prototype.getEnvironment=function(){var e,t=location.hostname;return e=t.includes("-dev")||t.startsWith("local")||t.startsWith("1")?o.Dev:t.includes("-qa")?o.QA:o.Prod,Promise.resolve(e)},t.prototype.getCache=function(e){try{var t=localStorage.getItem("BRIDGE_WEB_CACHE");if(!t)return Promise.resolve();var r=u(t);return Promise.resolve(e?r[e]:r)}catch(e){return Promise.reject(e)}},t.prototype.setCache=function(e,t){return this.getCache().then((function(r){var n,o=Object.assign({},r,((n={})[e]=t,n));return localStorage.setItem("BRIDGE_WEB_CACHE",s(o)),t}))},t.prototype.clearCache=function(){return localStorage.removeItem("BRIDGE_WEB_CACHE"),Promise.resolve()},t}(l),d=function(){function e(){}return e.createBridge=function(t,r){void 0===r&&(r=this.getPlatform());var n="".concat(t,"-").concat(r),o=e.bridgeMap[n];return o?new o:(console.error("未找到".concat(n,"的Bridge，已使用兜底方案，请进行适配!")),new l)},e.getPlatform=function(){return window.webkit?"ios":"web"},e.bridgeMap={"blurrr-ios":p,"blurrr-web":f},e}(),h=d,b={bridge:d};e.PGBridge=h,e.default=b,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=js-sdk.umd.js.map
