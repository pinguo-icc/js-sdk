!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["js-sdk"]={})}(this,(function(e){"use strict";var t,r;!function(e){e.CLOSE="closeWebView",e.GET_USER_INFO="getUserInfo",e.LOGIN="doLogin",e.GET_COMMON_PARAMS="getCommonParams",e.SAVE_FILE="saveImageToAlbum",e.QR_CODE_PARSER="callQRParser",e.SIGN="sign",e.SET_BAR_STATUS="setNativeBarStatus",e.SHOW_TOAST="showHint",e.QR_CODE_CLOSE="closeQRParser",e.SET_LOADING="setLoadingStatus",e.CALL_PHOTO_PICKER="callPhotoPicker",e.PURCHASE="purchase",e.GET_APP_PRODUCT_INFO="getIAPProductInfo",e.REPORT_EVENT="reportEvent",e.START_QR_SCAN="startQRScan",e.STOP_QR_SCAN="stopQRScan",e.REFRESH_CLIENT_DATA="refreshUserProjectsAndPresets",e.GET_CURRENT_ENV="getCurrentEnv",e.GET_H5_CACHE="getH5Cache",e.SET_H5_CACHE="setH5Cache",e.PLAY_VIDEO="playVideo",e.DO_SCAN="doScan",e.SAVE_RESOURCE="saveResource",e.APPLY_RESOURCE="applyResource",e.DO_LOCAL_CACHE="doLocalCache",e.SET_STATUS_BAR_STYLE="setStatusBarStyle",e.SHOW_SALES_PAGE="showSalesPage",e.REGISTER_NOTIFY="registerNotify",e.DO_SHARE="doShare",e.SET_HOME_TAB_BAR="setHomeTabbarStatus"}(t||(t={})),function(e){e.Prod="release",e.QA="qa",e.Dev="dev",e.Pre="operation"}(r||(r={}));var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function a(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,c)}s((o=o.apply(e,t||[])).next())}))}function c(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],o=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}function s(e){try{return JSON.parse(e)}catch(t){return e}}function u(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(e){return""}}var l=function(){function e(){this.IDIndex=0}return e.prototype.get=function(e){var t;return window.webkit&&window.webkit.messageHandlers&&(null===(t=window.webkit.messageHandlers[e])||void 0===t?void 0:t.postMessage)},e.prototype.execute=function(e,t){return window.webkit.messageHandlers[e].postMessage(t)},e.prototype.getUniqueID=function(){return"callback_".concat(this.IDIndex++)},e.prototype.bridgeCall=function(e,t,r){var o=this;return void 0===t&&(t={}),void 0===r&&(r={}),"function"!=typeof this.get(e)?(console.error(new Error("不存在type为".concat(e,"的方法可供调用！"))),Promise.reject({message:"invalid ".concat(e," method")})):new Promise((function(n,a){try{var c=i({},t),l=r.hasCallback,p=void 0===l||l,d=r.callbackFun,f=void 0;if(p){var h=o.getUniqueID();c.callback=h,f="function"!=typeof d?function(e){var t=s(e);return n(t),window[h]=null,t}:d,window[h]=f}var E=u(c);o.execute(e,E),"function"==typeof d&&n({})}catch(e){a(e)}}))},e.prototype.closePage=function(){this.bridgeCall(t.CLOSE,{_msg:"这条消息由前端发送，仅用于测试关闭接口调用"},{hasCallback:!1})},e.prototype.getUserInfo=function(){return this.bridgeCall(t.GET_USER_INFO)},e.prototype.login=function(){return this.bridgeCall(t.LOGIN)},e.prototype.getCommonParams=function(e){return this.bridgeCall(t.GET_COMMON_PARAMS)},e.prototype.saveFileByUrl=function(e){return this.bridgeCall(t.SAVE_FILE,{type:"url",data:e})},e.prototype.saveFileByBase64=function(e){return this.bridgeCall(t.SAVE_FILE,{type:"base64",data:e})},e.prototype.qrCodeOpen=function(e,r){return void 0===r&&(r="album"),this.bridgeCall(t.QR_CODE_PARSER,{scene:r},{callbackFun:e})},e.prototype.qrCodeClose=function(){return this.bridgeCall(t.QR_CODE_CLOSE)},e.prototype.qrCodeStop=function(){return this.bridgeCall(t.STOP_QR_SCAN)},e.prototype.qrCodeStart=function(){return this.bridgeCall(t.START_QR_SCAN)},e.prototype.sign=function(e){return this.bridgeCall(t.SIGN,e)},e.prototype.hideBar=function(){return this.bridgeCall(t.SET_BAR_STATUS,{status:!1},{hasCallback:!1})},e.prototype.showBar=function(){return this.bridgeCall(t.SET_BAR_STATUS,{status:!0},{hasCallback:!1})},e.prototype.showToast=function(e){return this.bridgeCall(t.SHOW_TOAST,{text:e})},e.prototype.showLoading=function(){return this.bridgeCall(t.SET_LOADING,{status:!0})},e.prototype.hideLoading=function(){return this.bridgeCall(t.SET_LOADING,{status:!1})},e.prototype.purchase=function(e,r){return this.bridgeCall(t.PURCHASE,{productId:e,method:r})},e.prototype.getAppProductInfo=function(e){return this.bridgeCall(t.GET_APP_PRODUCT_INFO,{productId:e})},e.prototype.reportEvent=function(e){return this.bridgeCall(t.REPORT_EVENT,e,{hasCallback:!1})},e.prototype.refreshApp=function(){return this.bridgeCall(t.REFRESH_CLIENT_DATA,{},{hasCallback:!1})},e.prototype.getEnvironment=function(){return this.bridgeCall(t.GET_CURRENT_ENV)},e.prototype.getCache=function(e){try{return this.bridgeCall(t.GET_H5_CACHE).then((function(t){var r=s(t||"{}")||{};return Promise.resolve(e?r[e]:r)}))}catch(e){return console.error(e),Promise.reject(e)}},e.prototype.setCache=function(e,r){var o=this;return this.getCache().then((function(n){var i,a=Object.assign({},n,((i={})[e]=r,i));return o.bridgeCall(t.SET_H5_CACHE,{body:u(a)})}))},e.prototype.clearCache=function(){return this.bridgeCall(t.SET_H5_CACHE,{body:u({})})},e.prototype.playVideoByApp=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(r){return[2,this.bridgeCall(t.PLAY_VIDEO,{data:e})]}))}))},e}(),p=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.prototype.get=function(e){var t;return window.webkit&&window.webkit.messageHandlers&&(null===(t=window.webkit.messageHandlers[e])||void 0===t?void 0:t.postMessage)},r.prototype.doScanWithKeyWord=function(e,r){return this.bridgeCall(t.DO_SCAN,{keyword:e,page:r})},r.prototype.doScanWithQRInfo=function(e,r){return this.bridgeCall(t.DO_SCAN,{QRInfo:e,page:r})},r.prototype.saveResource=function(e,r){return this.bridgeCall(t.SAVE_RESOURCE,{type:e,id:r})},r.prototype.applyResource=function(e,r){return this.bridgeCall(t.APPLY_RESOURCE,{type:e,id:r})},r.prototype.doLocalCache=function(e,r){return this.bridgeCall(t.DO_LOCAL_CACHE,{url:e,key:r})},r.prototype.setStatusBarStyle=function(e){return this.bridgeCall(t.SET_STATUS_BAR_STYLE,{style:e})},r.prototype.showSalesPage=function(){return this.bridgeCall(t.SHOW_SALES_PAGE,{})},r.prototype.registerNotify=function(e){return void 0===e&&(e="network"),this.bridgeCall(t.REGISTER_NOTIFY,{notifyType:e})},r.prototype.doShare=function(e,r){return this.bridgeCall(t.DO_SHARE,{text:e,rect:r})},r.prototype.showHomeTabBar=function(){this.bridgeCall(t.SET_HOME_TAB_BAR,{hidden:!1})},r.prototype.hideHomeTabBar=function(){this.bridgeCall(t.SET_HOME_TAB_BAR,{hidden:!0})},r}(l),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.get=function(e){return function(){}},t.prototype.execute=function(e,t){console.warn("H5模式下，不支持".concat(e,"方法的调用！"))},t.prototype.getUserInfo=function(){return Promise.resolve({vip:"no",hasFreeTicketToReceive:!0,collectedFreeTicketsCount:0,freeTicketCountConfig:888,balanceInvite:0,isLogin:!0,isVip:!0,isBindApple:!1,userId:"6501190edd88ea45697c59c5",vipExpireTime:"0",avater:"http://cloudcdn.c360dn.com/b02c799359294fb3fe054fa3baa7b38a-200",presetTotalIncome:9,presetCount:96,nickname:"文闪",balanceJuice:28,userToken:"V1RSRldueUpGV3lkTnAwR0lleDJtL2V5RUY1ZHlSeUJVNWphQWFESWtqWEVsL3BtVU9DVk1oU3M5c1pWR0UzOUhTZEhYOXA2SW95a09uZ0ZwY2p4cGVGWWl0T21TZktodzdpSE1FMzVnRXFpZVFTbmE1cVhxbHFRUWFpMVdWTmpHcGVKN2p2TEFWbW50NXg0QXRzVUhxN1UxelNHUlN5Tw=="})},t.prototype.login=function(){return this.getUserInfo()},t.prototype.getCommonParams=function(e){return a(this,void 0,void 0,(function(){var t,r;return c(this,(function(o){switch(o.label){case 0:return[4,this.getEnvironment()];case 1:return t=o.sent(),r=e||{},[2,Promise.resolve(i({"PG-AppID":"VideoBeats","PG-AppVersion":"1.9.00","PG-Channel":"toolchain","PG-DataEnv":t,"PG-Debug":"0","PG-EID":"d241c0694472aebc739d509eb740d52e3d6fc2021f9d71e0c6371fe91afbf51f96db1c91453b376a60f0d0e702cff2ab","PG-ENCB":"0","PG-ENCH":"0","PG-FA":"6f97129290a3e4c7c340154b9c30c431","PG-InitStamp":"1700039392","PG-Language":"zh-Hans","PG-Locale":"zh_CN","PG-Model":"iPad11,3","PG-Network":"WIFI","PG-OSVersion":"15.4.1","PG-Platform":"iOS","PG-ScreenSize":"834.0*1112.0","PG-Time":"1702620070","PG-UpgradeStamp":"1702547225","PG-UserID":"6501190edd88ea45697c59c5","PG-UserToken":"V1RSRldueUpGV3lkTnAwR0lleDJtL2V5RUY1ZHlSeUJVNWphQWFESWtqWEVsL3BtVU9DVk1oU3M5c1pWR0UzOUhTZEhYOXA2SW95a09uZ0ZwY2p4cGVGWWl0T21TZktodzdpSE1FMzVnRXFpZVFTbmE1cVhxbHFRUWFpMVdWTmpHcGVKN2p2TEFWbW50NXg0QXRzVUhxN1UxelNHUlN5Tw==","PG-UtcOffset":"28800"},r))]}}))}))},t.prototype.sign=function(e){return Promise.resolve("56610f9fce1cdd07098cd81d")},t.prototype.showToast=function(e){return alert(e),Promise.resolve()},t.prototype.getEnvironment=function(){var e,t=location.hostname;return e=t.includes("-dev")||t.startsWith("local")||t.startsWith("1")?r.Dev:t.includes("-qa")?r.QA:r.Prod,Promise.resolve(e)},t.prototype.getCache=function(e){try{var t=localStorage.getItem("BRIDGE_WEB_CACHE");if(!t)return Promise.resolve();var r=s(t);return Promise.resolve(e?r[e]:r)}catch(e){return Promise.reject(e)}},t.prototype.setCache=function(e,t){return this.getCache().then((function(r){var o,n=Object.assign({},r,((o={})[e]=t,o));return localStorage.setItem("BRIDGE_WEB_CACHE",u(n)),t}))},t.prototype.clearCache=function(){return localStorage.removeItem("BRIDGE_WEB_CACHE"),Promise.resolve()},t}(p),f=function(){function e(){}return e.createBridge=function(t,r){void 0===r&&(r=this.getPlatform()),setTimeout((function(){console.log("app: ".concat(t,", platform: ").concat(r))}),500);var o="".concat(t,"-").concat(r),n=e.bridgeMap[o];return n?new n:(console.error("未找到".concat(o,"的Bridge，已使用兜底方案，请进行适配!")),new l)},e.createBlurrrBridge=function(){return this.createBridge("blurrr")},e.getPlatform=function(){var e=window.navigator.userAgent.toLowerCase();if(setTimeout((function(){console.log("ua: ".concat(e))}),500),window.webkit&&/pinguo/.test(e)){if(/android/.test(e))return"android";if(/iphone|ipad|ipod|mac/.test(e))return"ios"}return"web"},e.version="1.0.16",e.bridgeMap={"blurrr-ios":p,"blurrr-web":d},e.EBridgeType=t,e}(),h=f,E={bridge:f};e.PGBridge=h,e.default=E,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=js-sdk.umd.js.map
